# ROI選擇與管理

## ROI基礎概念

### 什麼是ROI
- Region of Interest（感興趣區域）
- 用於標記和分析特定區域
- 支援多種形狀和類型
- 可以保存和重複使用

### ROI類型
1. 基本形狀
   - 矩形 (Rectangle)
   - 橢圓 (Oval)
   - 線段 (Line)
   - 點選 (Point)

2. 進階形狀
   - 多邊形 (Polygon)
   - 自由手繪 (Freehand)
   - 魔術棒 (Wand)
   - 選擇筆刷 (Selection Brush)

## ROI工具使用

### 基本操作
1. 創建ROI
   ```
   選擇工具 > 在影像上拖曳
   ```
   - 工具列選擇
   - 快捷鍵使用
   - 精確定位

2. 修改ROI
   - 移動：按住左鍵拖曳
   - 調整大小：拖曳邊界點
   - 旋轉：CTRL + 拖曳

### 進階功能
1. ROI管理器
   ```
   Analyze > Tools > ROI Manager...
   ```
   - 添加/刪除ROI
   - 命名和組織
   - 批次操作

2. ROI操作
   - 合併
   - 分割
   - 複製/貼上
   - 填充/清除

## 測量與分析

### 基本測量
1. 幾何測量
   ```
   Analyze > Measure
   ```
   - 面積
   - 周長
   - 中心點座標
   - 方向

2. 密度測量
   - 平均灰度值
   - 積分密度
   - 標準差
   - 最大/最小值

### 統計分析
1. 數據收集
   - 批次測量
   - 數據表格
   - 結果匯出

2. 統計處理
   - 基本統計
   - 直方圖分析
   - 相關性分析

## ROI保存與讀取

### 檔案格式
1. ROI檔案
   - .roi（單個ROI）
   - .zip（ROI集合）
   - 檔案結構

2. 設置保存
   - 測量參數
   - 顯示選項
   - 分析設定

### 批次處理
1. 載入ROI
   ```
   ROI Manager > More > Open...
   ```
   - 批次導入
   - 自動對應
   - 錯誤處理

2. 應用ROI
   - 批次測量
   - 區域處理
   - 結果輸出

## 實際應用案例

### 細胞分析
1. 細胞計數
   - 自動檢測
   - 手動校正
   - 結果統計

2. 形態測量
   - 大小分布
   - 形狀分析
   - 密度評估

### 組織分析
1. 區域分割
   - 組織分層
   - 結構識別
   - 面積計算

2. 密度分析
   - 染色強度
   - 分布特徵
   - 時序變化

## 進階技巧

### 自動化處理
1. 巨集錄製
   ```
   Plugins > Macros > Record...
   ```
   - 操作錄製
   - 參數設置
   - 批次執行

2. 自定義處理
   - 腳本編寫
   - 功能擴展
   - 工作流程優化

### 多通道應用
1. 通道同步
   - ROI複製
   - 位置對應
   - 數據關聯

2. 共定位分析
   - 重疊區域
   - 信號相關
   - 定量評估

## 常見問題與解決

### 操作問題
1. 精確選擇
   - 放大視圖
   - 使用輔助工具
   - 邊界調整

2. ROI管理
   - 命名規範
   - 組織方法
   - 備份策略

### 分析問題
1. 測量誤差
   - 校正方法
   - 誤差評估
   - 優化建議

2. 數據處理
   - 異常值處理
   - 數據標準化
   - 結果驗證

## 最佳實踐

### 工作流程優化
1. 準備階段
   - 影像預處理
   - 參數設置
   - 工具準備

2. 執行階段
   - 系統化操作
   - 質量控制
   - 結果記錄

### 數據管理
1. 組織結構
   - 檔案命名
   - 目錄結構
   - 版本控制

2. 結果保存
   - 原始數據
   - 處理結果
   - 分析報告 