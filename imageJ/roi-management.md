# ROI選擇與管理

## ROI基礎概念

### 什麼是ROI
- Region of Interest（感興趣區域）
- 用於標記和分析特定區域
- 支援多種形狀和類型
- 可以保存和重複使用
- 影像中特定的選擇區域
- 用於局部分析和測量
- 可以保存和重複使用
- 支援多種幾何形狀

### ROI類型
1. 基本形狀
    - 矩形 (Rectangle)
    - 橢圓 (Oval)
    - 線段 (Line)
    - 點 (Point)
2. 進階形狀
    - 多邊形 (Polygon)
    - 自由手繪 (Freehand)
    - 魔術棒 (Wand)
    - 選擇筆刷 (Selection Brush)

## ROI工具使用

### 選擇工具
- 矩形工具（Rectangle Tool）
    - 按住Shift：正方形
    - 按住Alt：以中心點展開
  
- 橢圓工具（Oval Tool）
    - 按住Shift：正圓
    - 按住Alt：以中心點展開

- 多邊形工具（Polygon Tool）
    - 單擊：添加頂點
    - 雙擊：完成選擇
    - 按住Shift：限制角度

- 修改ROI
    - 移動：按住左鍵拖曳
    - 調整大小：拖曳邊界點
    - 旋轉：CTRL + 拖曳
    - 添加/減去區域


### 進階功能
- ROI管理器
   ```
   Analyze > Tools > ROI Manager...
   ```
- ROI操作
     - 開啟ROI管理器：`Analyze > Tools > ROI Manager`
     - 添加ROI：`Add`
     - 刪除ROI：`Delete`
     - 重命名ROI：`Rename`
     - 顯示所有ROI：`Show All`
     - 分割
     - 複製/貼上
     - 填充/清除
- ROI組合
     - 多個ROI合併
     - 交集運算
     - 聯集運算
     - 差集運算


## 測量與分析

### 基本測量
1. 幾何測量
   ```
   Analyze > Measure
   ```
    - 面積
    - 周長
    - 中心點座標
    - 方向

2. 密度測量
    - 平均灰度值
    - 積分密度
    - 標準差
    - 最大/最小值

### 統計分析
1. 數據收集
    - 批次測量
    - 數據表格
    - 結果匯出

2. 統計處理
    - 基本統計
    - 直方圖分析
    - 相關性分析

## ROI保存與讀取

### 檔案格式
1. ROI檔案
    - .roi（單個ROI）
    - .zip（ROI集合）
    - 檔案結構

2. 設置保存
    - 測量參數
    - 顯示選項
    - 分析設定

### 批次處理
1. 載入ROI
   ```
   ROI Manager > More > Open...
   ```
    - 批次導入
    - 自動對應
    - 錯誤處理

2. 應用ROI
    - 批次測量
    - 區域處理
    - 結果輸出



## 實際應用案例

### 細胞分析
1. 細胞計數
    - 自動檢測
    - 手動校正
    - 結果統計

2. 形態測量
    - 大小分布
    - 形狀分析
    - 密度評估

### 組織分析
1. 區域分割
    - 組織分層
    - 結構識別
    - 面積計算

2. 密度分析
    - 染色強度
    - 分布特徵
    - 時序變化

## 進階技巧

### 自動化處理
1. 巨集錄製
```
Plugins > Macros > Record...
   ```
    - 操作錄製
    - 參數設置
    - 批次執行



### 多通道應用
1. 通道同步
    - ROI複製
    - 位置對應
    - 數據關聯

2. 共定位分析
    - 重疊區域
    - 信號相關
    - 定量評估

## 實作練習

### 練習 1：基本ROI操作
1. 建立不同類型的ROI
2. 修改和調整ROI
3. 使用ROI manager
4. 保存和讀取ROI

### 練習 2：進階ROI應用
1. ROI的組合運算
2. 批次ROI處理
3. 自動ROI生成
4. ROI based分析