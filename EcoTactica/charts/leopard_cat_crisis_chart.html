<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>綠蠵龜保育策略關係圖</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body { 
            font-family: 'Arial', 'Helvetica', sans-serif; 
            display: flex; 
            flex-direction: column;
            justify-content: flex-start; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding-top: 20px; /* Add some padding at the top */
            background-color: #f4f4f4; 
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        /* Container for the Mermaid div to manage overflow and initial sizing */
        .mermaid-container {
            background-color: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            width: 95%; /* Start with a good width */
            max-width: 1600px; /* Allow it to be quite wide if needed */
            overflow-x: auto; /* Allow horizontal scrolling for large diagrams */
        }
        /* Apply scaling to the Mermaid diagram itself */
        .mermaid {
            transform-origin: top left; /* Scale from the top-left corner */
            /* transform: scale(1.2); */ /* Example: Scale by 20%. Adjust as needed. */
        }
    </style>
</head>
<body>
    <h1>石虎保育：問題解決流程圖</h1>
    <div class="mermaid-container">
        <div class="mermaid">
graph TD
    %% External Flags
    F_PublicAwareness[/"民眾保育總體意識提升 (外部)"/]:::externalFlag
    F_MonitoringNetwork[/"全國生態監測網絡建立 (外部)"/]:::externalFlag
    F_IntCoop[/"國際合作 (外部)"/]:::externalFlag

    %% 危機爆發
    subgraph 危機爆發
        direction TB
        E_LeopardCatDecline["石虎族群減少"]:::event --> F_LeopardCatCrisis["石虎危機"]:::crisisFlag
    end

    %% 衍生事件
    subgraph 衍生事件_需石虎危機
        direction TB
        F_LeopardCatCrisis --> E_Roadkill["石虎路殺事件頻傳"]:::event
        F_LeopardCatCrisis --> E_Poaching["非法盜獵石虎事件"]:::event
    end

    %% 階段一：提升保育意識
    subgraph 階段一_提升保育意識
        direction TB
        F_PublicAwareness --> S_Education["推廣石虎保育教育"]:::strategy
        S_Education --> F_LeopardCatAwareness["石虎保育意識強化"]:::flag
    end

    %% 階段二：初步棲地與社群行動
    subgraph 階段二_初步棲地與社群行動
        direction TB
        F_LeopardCatAwareness --> S_HabitatInit["石虎友善棲地營造初步計畫"]:::strategy
        F_MonitoringNetwork --> S_HabitatInit
        S_HabitatInit --> F_HabitatStarted["石虎友善棲地營造啟動"]:::flag
        S_HabitatInit --> F_CommunityNetwork["在地保育合作網絡初步建立"]:::flag
    end

    %% 階段三：應對特定威脅
    subgraph 階段三_應對特定威脅
        direction TB
        F_HabitatStarted --> S_RoadkillPrevention["強化石虎路殺防治措施"]:::strategy
        F_MonitoringNetwork --> S_RoadkillPrevention
        S_RoadkillPrevention --> F_RoadkillMeasures["石虎路殺防治措施落實"]:::flag

        F_CommunityNetwork --> S_AntiPoaching["建立反盜獵網絡與棲地連結"]:::strategy
        S_AntiPoaching --> F_AntiPoachingNetwork["反盜獵網絡成形"]:::flag
        S_AntiPoaching --> F_HabitatConnectivity["石虎棲地連結改善"]:::flag
    end

    %% 階段四：整合性族群復育計畫
    subgraph 階段四_整合族群復育
        direction TB
        F_RoadkillMeasures --> S_RecoveryProgram["石虎族群復育整合計畫"]:::strategy
        F_AntiPoachingNetwork --> S_RecoveryProgram
        F_HabitatConnectivity --> S_RecoveryProgram
        F_IntCoop --> S_RecoveryProgram
        S_RecoveryProgram --> F_LeopardCatRecovered["石虎族群恢復"]:::goalFlag
        S_RecoveryProgram --> F_HabitatConnected["石虎棲地成功連結"]:::goalFlag
        S_RecoveryProgram --> F_LeopardCatCrisis
    end

    %% 事件解決條件
    subgraph 事件解決條件
        direction TB
        F_LeopardCatRecovered --> E_LeopardCatDecline
        F_RoadkillMeasures --> E_Roadkill
        F_LeopardCatRecovered --> E_Roadkill
        F_AntiPoachingNetwork --> E_Poaching
        F_LeopardCatRecovered --> E_Poaching
    end

    %% Style 定義
    classDef event fill:#FFF0F0,stroke:#A52A2A,stroke-width:2px,color:#333,rx:5px,ry:5px
    classDef strategy fill:#F0FFF0,stroke:#228B22,stroke-width:2px,color:#333,rx:5px,ry:5px
    classDef flag fill:#F0FFFF,stroke:#1E90FF,stroke-width:2px,color:#333
    classDef crisisFlag fill:#FFF8DC,stroke:#FF8C00,stroke-width:2px,color:#333
    classDef goalFlag fill:#E6E6FA,stroke:#8A2BE2,stroke-width:2px,color:#333
    classDef externalFlag fill:#F5F5F5,stroke:#696969,stroke-width:1px,color:#333,stroke-dasharray:5 5


        </div>
    </div>
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'base', // 'default', 'forest', 'dark', 'neutral', 'base'
            logLevel: 3, // For debugging mermaid rendering - Increased log level
            themeVariables: {
                primaryColor: '#f0f8ff', // AliceBlue for background of diagram
                primaryTextColor: '#333',
                lineColor: '#555',
                fontSize: '15px' // Slightly increased base font size
            },
        });
    </script>
</body>
</html>
